# Практическая работа. Модуль 17
## Цели практической работы
* Попрактиковаться в реализации REST API с помощью модуля `Flask-RESTful` (или `Flask-RESTX` по желанию).
* Научиться сериализовывать и валидировать JSON с помощью модуля `marshmallow`.

## Что входит в практическую работу
1. Обновить структуру БД.
2. Создать REST API для работы с книгами.
3. Создать REST API для работы с авторами.

## Задача 1. Обновление структуры БД
### Что нужно сделать
1. Примените знания, полученные в предыдущем модуле.

    Сейчас в базе данных автор хранится как строковое поле в модели книги. Это может привести к аномалиям данных. Например, А. С. Пушкин и Александр Сергеевич Пушкин — один и тот же автор, но в базе эти имена будут храниться как два разных автора.
2. Создайте отдельную сущность «Автор», чтобы избежать этого. В ней должны быть следующие поля:
   * id — первичный ключ;
   * first_name — имя автора;
   * last_name — фамилия автора;
   * middle_name — отчество автора (необязательно).

Так книга будет хранить не строковое представление автора, а внешний ключ на сущность.

### Советы и рекомендации
Процесс, который вы проходите в задаче, называется приведением к первой нормальной форме. Вы можете подробнее узнать о нормализации [в этой статье](https://habr.com/ru/post/254773/).

### Что оценивается
* Сущности в изменённой схеме имеют первичные ключи.
* Книга имеет внешний ключ, который ссылается на автора.
* При создании книги теперь используется не имя автора, а его ID.
* Предусмотрено каскадное удаление всех книг при удалении автора.

## Задача 2. Создание REST API для работы с книгами
### Что нужно сделать
Вы не завершили создание API по работе с конкретной книгой. Реализуйте класс ресурса «Книга» и добавьте следующие методы:

* `PUT /api/books/{id}` — изменение книги;
* `GET /api/books/{id}` — получение информации о книге;
* `DELETE /api/books/{id}` — удаление книги.

### Советы и рекомендации
* В видео мы рассматривали применение `Flask-RESTful`, но вы можете использовать более продвинутую версию этой библиотеки — [`Flask-RESTX`](https://flask-restx.readthedocs.io/en/latest/quickstart.html). Разработчики активно поддерживают её, с ней можно быстро и удобно создавать сервисы REST API.
* Также существует метод PATCH, который частично изменяет ресурс. Если PUT изменяет объект полностью и требует наличия всех обязательных полей, то PATCH изменяет только переданные поля. Попробуйте реализовать и его.

### Что оценивается
* Есть валидация ID автора.
* Все endpoints работают корректно, взаимодействуя с БД.

## Задача 3. Создание REST API для работы с авторами
### Что нужно сделать
Создайте класс ресурса «Автор» и добавьте следующие методы:

* `POST /api/authors/` — создание автора;
* `GET /api/authors/{id}` — просмотр всех книг автора;
* `DELETE /api/authors/{id}` — удаление автора вместе со всеми его книгами.

Также реализуйте возможность создания автора при добавлении новой книги. Не забудьте указать все необходимые поля.

### Советы и рекомендации
Вы можете узнать больше об использовании вложенных схем в `marshmallow` [в этой статье](https://marshmallow.readthedocs.io/en/stable/nesting.html).

### Что оценивается
* Ресурс реализован в виде отдельного класса.
* Имеется возможность создать автора при добавлении книги.
* При удалении автора удаляются все его книги.

## Общие советы и рекомендации
Выполнить задания вам помогут следующие ресурсы:

* Статья [REST API Best Practices](https://habr.com/ru/post/351890/).
* Статья «[Методы HTTP-запроса](https://developer.mozilla.org/ru/docs/Web/HTTP/Methods)».
* Статья «[Коды ответа HTTP](https://developer.mozilla.org/ru/docs/Web/HTTP/Status)».
* Документация [Flask-RESTful](https://flask-restful.readthedocs.io/en/latest/).
* Документация [Flask-RESTX](https://flask-restx.readthedocs.io/en/latest/).
* Документация [marshmallow](https://marshmallow.readthedocs.io/en/stable/).

## Что оценивается в практической работе
* Используется сериализация с помощью модуля `marshmallow`.
* Имеется валидация схем.
* Используются корректные коды состояния HTTP. Например, 404, если ресурс не найден, или 201, если ресурс создан.
* Используются параметризованные запросы.
* Названия переменных, функций и классов имеют значимые имена.
